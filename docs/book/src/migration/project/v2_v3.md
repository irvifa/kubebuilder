# Migration from project config v2 to v3

Make sure you understand the [differences between Kubebuilder v2 and v3](/migration/v2vsv3.md)
before continuing

Please ensure you have followed the [installation guide](/quick-start.md#installation)
to install the required components.

## Steps to migrate

<aside class="note warning">
<h1>Note</h1>

The following steps will be based on the [QuickStart][QuickStart] steps.

</aside>

The following changes need to be applied to the project configuration file (`PROJECT`) that can be found at the root directory:

- Add the `projectName`

The project name is the name of the project directory in lowercase:

```yaml
...
projectName: example
...
```

- Add the `layout`

The default plugin layout which is equivalent to the previous versions is `go.kubebuilder.io/v2`:

```yaml
...
layout: go.kubebuilder.io/v2
...
```

- Update the `version`

The `version` field represents the version of Project layouts. So, you ought to update this to `3-alpha`:

```yaml
...
version: 3-alpha`
...
```

- Add the `crd-version` 

The `crd-version` field represents the version of the `apiextensions.k8s.io/` API used to scaffold your APIs(CRDs). So, you ought to add this to `api.crdVersion: v1beta` for each resource scaffold:

```yaml
resources:
- api:
    crdVersion: v1beta
  group: webapp
  kind: Guestbook
  version: v1
``` 

- Add the `webhook-version` 

The `webhook-version` field represents the version of the `apiextensions.k8s.io/`, `admissionregistration.k8s.io/` and `cert-manager.io/` APIs used to scaffold your webhooks. So, you ought to add this to `webhooks.webhookVersion: v1beta` for each resource used to scaffold a webhook:

```yaml
- api:
    crdVersion: v1beta
  group: webapp
  kind: Guestbook
  version: v1
  webhooks:
    webhookVersion: v1beta
```

The final PROJECT file would look like:

```yaml
domain: my.domain
layout: go.kubebuilder.io/v2
projectName: example
repo: example
resources:
- api:
    crdVersion: v1beta
  group: webapp
  kind: Guestbook
  version: v1
  webhooks:
    webhookVersion: v1beta
version: 3-alpha
```

### Verification

Finally, we can run `make` and `make docker-build` to ensure things are working
fine.


[QuickStart]: /docs/book/src/quick-start.md
[envtest]: https://book.kubebuilder.io/reference/testing/envtest.html
